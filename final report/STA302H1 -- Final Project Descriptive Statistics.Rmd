---
title: "STA302H1 -- Final Project Descriptive Statistics"
author: "Danny Chen"
date: "August 10, 2021"
output:
  pdf_document: default
---

```{r setup, include = FALSE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(dplyr)
library(tidyverse)
```

# Import STA302H1 Study Time and COVID Contemplation Time vs. Quiz Performance Dataset

```{r echo = FALSE, message = FALSE}
setwd("~/Desktop/sta302h1/STA302H1 -- Projects/final report")
sta302_performance_data = read.csv("./data.csv", header = TRUE)
attach(sta302_performance_data)
```

# Data Cleaning

First, I'll clean my data.

```{r}
cleaned_sta302_performance_data <- sta302_performance_data %>%
    # Create a new "country" column, which is just "Country" but whose entries are factors.
    mutate(country = as.factor(Country)) %>%

    # Remove the "X" column: it's simply the row number, which isn't very useful.
    # Remove the "Country" column: column "country" already exists
    select(-X, -Country) %>%
    
    # Rearrange similar columns side-by-side.
    relocate(country,
             COVID.hours..W1., COVID.hours..W2., 
             COVID.hours..W3., COVID.hours..W4.,
             STA302.hours..W1., STA302.hours..W2., 
             STA302.hours..W3., STA302.hours..W4.,
             Quiz_1_score, Quiz_2_score, 
             Quiz_3_score, Quiz_4_score)
    
    # Identify rows with no quiz 4. 
    # These indicate students who have dropped STA302H1, and who 
    # should be excluded from the final data.
```

\break

# Rows With At Least One NA

Rows with at least one NA deserve closer examination. \newline
Some of the rows might only have 1 - 2 NAs and are therefore salvageable, which is OK. \newline
Other rows may contain 3 or more NAs, and might indicate students who have dropped STA302H1. We'd like to exclude them from our analysis.

```{r}
at_least_one_NA = function(data) {
  return (rowSums(is.na(cleaned_sta302_performance_data)) >= 1)
}

rows_with_some_NAs = cleaned_sta302_performance_data[
  at_least_one_NA(cleaned_sta302_performance_data),
]
```

\break

# Rows with Mistyped Columns

Rows whose columns are mis-typed may need to be corrected via imputation.

```{R}
rows_with_mistyped_columms = cleaned_sta302_performance_data[c(38, 83, 84, 117),]
# row 83: Country -> "canada" -- DONE
# row 84: Country -> "canada" -- DONE

# row 117: COVID.hours..W4. -> 0.5 hours -- DONE

# row 38:  STA302.hours..W3. -> 5.5<U+00A0> -- DONE
# row 117: STA302.hours..W4. -> 7.5 hours -- DONE

# library(janitor)
# use it to clean up data.
```


\break

# Find Significance Predictor Variables, Select Predictor Variables Based on Criterion

```{r}
# use week 5b slides -- choose model selection criterion to pick predictor variables.


# use lm() on a bunch of predictor variables to determine significant
# predictor variables.


```

\break

# Histograms

```{r}
# TODO: See toy programs to learn how to create histograms with ggplot.
# TODO: See Demo 1 to figure out how to add histograms using grid.arrange.

display_histogram <- function(data, predictor_variable, histogram_title, x_axis_label) {
  ggplot(data = tibble(data), mapping = aes(x = predictor_variable)) +
    geom_histogram(col = "black", fill = "red", bins = 30) +
    labs(title = histogram_title, y = "Frequency", x = x_axis_label) + 
    geom_vline(mapping = aes(xintercept = mean(predictor_variable, na.rm = TRUE)),
               color = "blue", linetype = "solid") +
    geom_vline(mapping = aes(xintercept = median(predictor_variable, na.rm = TRUE)),
               color = "dark green", linetype = "dotted")
}
```

```{r}
display_histogram(cleaned_sta302_performance_data, 
                  cleaned_sta302_performance_data$COVID.hours..W1., 
                  "Histogram of Week 1 Time Spent Thinking About COVID-19",
                  "Time Spent Thinking About COVID-19 (hours)")
```

\break

```{r}
display_histogram(cleaned_sta302_performance_data, 
                  cleaned_sta302_performance_data$COVID.hours..W2., 
                  "Histogram of Week 2 Time Spent Thinking About COVID-19",
                  "Time Spent Thinking About COVID-19 (hours)")
```

\break

```{r}
display_histogram(cleaned_sta302_performance_data, 
                  cleaned_sta302_performance_data$COVID.hours..W3., 
                  "Histogram of Week 3 Time Spent Thinking About COVID-19",
                  "Time Spent Thinking About COVID-19 (hours)")
```

\break

```{r}
display_histogram(cleaned_sta302_performance_data, 
                  cleaned_sta302_performance_data$COVID.hours..W4., 
                  "Histogram of Week 4 Time Spent Thinking About COVID-19",
                  "Time Spent Thinking About COVID-19 (hours)")
```

\break

```{r}
display_histogram(cleaned_sta302_performance_data, 
                  cleaned_sta302_performance_data$STA302.hours..W1., 
                  "Histogram of Week 1 Time Spent Studying for STA302H1",
                  "Time Spent Studying for STA302H1 (hours)")
```

\break

```{r}
display_histogram(cleaned_sta302_performance_data, 
                  cleaned_sta302_performance_data$STA302.hours..W2., 
                  "Histogram of Week 2 Time Spent Studying for STA302H1",
                  "Time Spent Studying for STA302H1 (hours)")
```

\break

```{r}
display_histogram(cleaned_sta302_performance_data, 
                  cleaned_sta302_performance_data$STA302.hours..W3., 
                  "Histogram of Week 3 Time Spent Studying for STA302H1",
                  "Time Spent Studying for STA302H1 (hours)")
```

\break

```{r}
display_histogram(cleaned_sta302_performance_data, 
                  cleaned_sta302_performance_data$STA302.hours..W4., 
                  "Histogram of Week 4 Time Spent Studying for STA302H1",
                  "Time Spent Studying for STA302H1 (hours)")
```

\break

```{r}
display_histogram(cleaned_sta302_performance_data, 
                  cleaned_sta302_performance_data$Quiz_1_score, 
                  "Histogram of Quiz 1 Scores",
                  "Quiz Score (out of 10)")
```

\break

```{r}
display_histogram(cleaned_sta302_performance_data, 
                  cleaned_sta302_performance_data$Quiz_2_score, 
                  "Histogram of Quiz 2 Scores",
                  "Quiz Score (out of 10)")
```

\break

```{r}
display_histogram(cleaned_sta302_performance_data, 
                  cleaned_sta302_performance_data$Quiz_3_score, 
                  "Histogram of Quiz 3 Scores",
                  "Quiz Score (out of 10)")
```

\break

```{r}
display_histogram(cleaned_sta302_performance_data, 
                  cleaned_sta302_performance_data$Quiz_4_score, 
                  "Histogram of Quiz 4 Scores",
                  "Quiz Score (out of 10)")
```

\break

# Boxplots

```{r}
# TODO: See STA248H1 notes to figure out how to create boxplots. -- DONE
# TODO: See toy program of boxplots to see how to color them by factor

display_boxplot <- function(data, predictor_variable, boxplot_title, y_axis_label) {
  ggplot(mapping = aes(x = Country, y = predictor_variable)) +
    geom_boxplot(mapping = aes(x = Country, y = predictor_variable)) +
    labs(title = boxplot_title,
         x = "Country",
         y = y_axis_label)
}
```

```{r}
display_boxplot(cleaned_sta302_performance_data, COVID.hours..W1.,
                "Country vs. Week 1 Time Spent Thinking About COVID-19",
                "Time Spent Thinking About COVID-19 (hours)")
```

\break

```{R}
display_boxplot(cleaned_sta302_performance_data, COVID.hours..W2.,
                "Country vs. Week 2 Time Spent Thinking About COVID-19",
                "Time Spent Thinking About COVID-19 (hours)")
```

\break

```{R}
display_boxplot(cleaned_sta302_performance_data, COVID.hours..W3.,
                "Country vs. Week 3 Time Spent Thinking About COVID-19",
                "Time Spent Thinking About COVID-19 (hours)")
```

\break

```{R}
display_boxplot(cleaned_sta302_performance_data, COVID.hours..W4.,
                "Country vs. Week 4 Time Spent Thinking About COVID-19",
                "Time Spent Thinking About COVID-19 (hours)")
```

\break

```{R}
display_boxplot(cleaned_sta302_performance_data, STA302.hours..W1.,
                "Country vs. Week 1 Time Spent Studying For STA302H1",
                "Time Spent Studying For STA302H1 (hours)")
```

\break

```{R}
display_boxplot(cleaned_sta302_performance_data, STA302.hours..W2.,
                "Country vs. Week 2 Time Spent Studying For STA302H1",
                "Time Spent Studying For STA302H1 (hours)")
```

\break

```{R}
display_boxplot(cleaned_sta302_performance_data, STA302.hours..W3.,
                "Country vs. Week 3 Time Spent Studying For STA302H1",
                "Time Spent Studying For STA302H1 (hours)")
```

\break

```{R}
display_boxplot(cleaned_sta302_performance_data, STA302.hours..W4.,
                "Country vs. Week 4 Time Spent Studying For STA302H1",
                "Time Spent Studying For STA302H1 (hours)")
```

\break

```{R}
display_boxplot(cleaned_sta302_performance_data, Quiz_1_score,
                "Country vs. Quiz 1 Score", "Score (out of 10)")
```

\break

```{R}
display_boxplot(cleaned_sta302_performance_data, Quiz_2_score,
                "Country vs. Quiz 2 Score", "Score (out of 10)")
```

\break

```{R}
display_boxplot(cleaned_sta302_performance_data, Quiz_3_score,
                "Country vs. Quiz 3 Score", "Score (out of 10)")
```

\break

```{R}
display_boxplot(cleaned_sta302_performance_data, Quiz_4_score,
                "Country vs. Quiz 4 Score", "Score (out of 10)")
```

\break

# Scatterplots

```{r}
# pairwise scatterplot
pairs(~COVID.hours..W1. + COVID.hours..W2. + COVID.hours..W3. + COVID.hours..W4. +
      STA302.hours..W1. + STA302.hours..W2. + STA302.hours..W3. + STA302.hours..W4. +
      Quiz_1_score + Quiz_2_score + Quiz_3_score + Quiz_4_score,
      data = cleaned_sta302_performance_data)
```

\break

# Correlation Matrix

```{r}
# take out country column
# TODO: Or create separate correlation matrices for each country?
no_country = cleaned_sta302_performance_data %>%
  select(-country)
```

```{r}
# Find correlation matrix to determine candidate significant predictor values.
# library(GGally)
colnames(no_country) <- c("W1COV", "W2COV", "W3COV", "W4COV", 
                          "W1302", "W2302", "W3302", "W4302", 
                          "Q1", "Q2", "Q3", "Q4")
# ggcorr(no_country, label = TRUE, label_round = 2)
round(cor(no_country, use = "complete.obs"), 2)  # TODO: na.rm = true
```

\break

# 5-Number Summary Statistics

## STA302H1 Hours 5-Number Summary

```{r}
summary(sta302_performance_data$STA302.hours..W1.)
summary(sta302_performance_data$STA302.hours..W2.)
summary(sta302_performance_data$STA302.hours..W3.)
summary(sta302_performance_data$STA302.hours..W4.)
```

\break

## COVID Hours 5-Number Summary

```{r}
summary(sta302_performance_data$COVID.hours..W1.)
summary(sta302_performance_data$COVID.hours..W2.)
summary(sta302_performance_data$COVID.hours..W3.)
summary(sta302_performance_data$COVID.hours..W4.)
```

\break

## Quiz Scores 5-Number Summary

```{r}
summary(sta302_performance_data$Quiz_1_score)
summary(sta302_performance_data$Quiz_2_score)
summary(sta302_performance_data$Quiz_3_score)
summary(sta302_performance_data$Quiz_4_score)
```
