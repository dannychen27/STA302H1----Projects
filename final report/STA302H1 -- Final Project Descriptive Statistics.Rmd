---
title: "STA302H1 -- Final Project Descriptive Statistics"
author: "Danny Chen"
date: "August 10, 2021"
output:
  pdf_document: default
---

```{r setup, include = FALSE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(dplyr)
library(tidyverse)
```

# Import STA302H1 Study Time and COVID Contemplation Time vs. Quiz Performance Dataset

```{r echo = FALSE, message = FALSE}
setwd("~/Desktop/sta302h1/STA302H1 -- Projects/final report")
sta302_performance_data = read.csv("./data.csv", header = TRUE)
attach(sta302_performance_data)
```

# Data Cleaning

First, I'll clean my data.

```{r}
cleaned_sta302_performance_data <- sta302_performance_data %>%
    # Create a new "country" column, which is just "Country" but whose entries are factors.
    mutate(country = as.factor(Country)) %>%

    # Remove the "X" column: it's simply the row number, which isn't very useful.
    # Remove the "Country" column: column "country" already exists
    select(-X, -Country) %>%
    
    # Group student overall quiz 4 scores from highest to lowest.
    arrange(desc(Quiz_4_score)) %>%
    
    # Rearrange similar columns side-by-side.
    relocate(country,
             COVID.hours..W1., COVID.hours..W2., 
             COVID.hours..W3., COVID.hours..W4.,
             STA302.hours..W1., STA302.hours..W2., 
             STA302.hours..W3., STA302.hours..W4.,
             Quiz_1_score, Quiz_2_score, 
             Quiz_3_score, Quiz_4_score)
    
    # TODO: Make sure all country names are lowercase.
    # e.g. "Canada" and "canada" are the same country.
    # 1. Consider running a for loop that makes all rows in column "Country" lowercase,
    # 2. Consider string replacement on "Canada" -> "canada"?

    # TODO: Make sure all STA302H1 hours and COVID contemplation hours are
    # all in numeric form.
    # 1. use as.numeric()?
    
    # Identify rows with no quiz 4. 
    # These indicate students who have dropped STA302H1, and who 
    # should be excluded from the final data.

head(cleaned_sta302_performance_data, n = 15)
```

\break

# Identifying Anomalous Data

Rows with at least one NA deserve closer examination.
Some of the rows might only have 1 - 2 NAs and are therefore salvageable, which is OK. Other rows may contain 3 or more NAs, and might indicate students who have dropped STA302H1. We'd like to exclude them from our analysis.

```{r}
at_least_one_NA = function(data) {
  return (rowSums(is.na(cleaned_sta302_performance_data)) >= 1)
}

rows_with_some_NAs = cleaned_sta302_performance_data[
  at_least_one_NA(cleaned_sta302_performance_data),
]
rows_with_some_NAs
```

\break

# Rows with Mistyped Columns

Rows whose columns are mis-typed may need to be corrected via imputation.

```{R echo = FALSE, message = FALSE}
rows_with_mistyped_columms = cleaned_sta302_performance_data[c(38, 83, 84, 117),]
rows_with_mistyped_columms
# row 83: Country -> "canada" -- DONE
# row 84: Country -> "canada" -- DONE

# row 117: COVID.hours..W4. -> 0.5 hours -- DONE

# row 38:  STA302.hours..W3. -> 5.5<U+00A0> -- DONE
# row 117: STA302.hours..W4. -> 7.5 hours -- DONE

# library(janitor)
# use it to clean up data.

# TODO: You're allowed to change entries manually though.
```


\break

# Select Predictor Variables, Find Their Significance

```{r}
# use week 5b slides -- choose model selection criterion to pick predictor variables.


# use lm() on a bunch of predictor variables to determine significant
# predictor variables.


```

\break

# Histograms

```{r}
# TODO: See Demo 1 to figure out how to add histograms in a matrix format.

# TODO: create histograms with ggplot, and then grid.arrange them together.
```

\break

# Boxplots

```{r}
# TODO: See STA248H1 notes to figure out how to create boxplots. -- DONE
# TODO: See toy program of boxplots to see how to color them by factor

ggplot(data = cleaned_sta302_performance_data) +
  geom_boxplot(mapping = aes(x = Country, y = COVID.hours..W1.)) +
  labs(title = "Country vs. Week 1 Time Spent Thinking About COVID-19",
       x = "Country",
       y = "Time Spent Thinking About COVID-19 (hours)")

ggplot(data = cleaned_sta302_performance_data) +
  geom_boxplot(mapping = aes(x = Country, y = COVID.hours..W2.)) +
  labs(title = "Country vs. Week 2 Time Spent Thinking About COVID-19",
       x = "Country",
       y = "Time Spent Thinking About COVID-19 (hours)")

ggplot(data = cleaned_sta302_performance_data) +
  geom_boxplot(mapping = aes(x = Country, y = COVID.hours..W3.)) +
  labs(title = "Country vs. Week 3 Time Spent Thinking About COVID-19",
       x = "Country",
       y = "Time Spent Thinking About COVID-19 (hours)")

ggplot(data = cleaned_sta302_performance_data) +
  geom_boxplot(mapping = aes(x = Country, y = COVID.hours..W4.)) +
  labs(title = "Country vs. Week 4 Time Spent Thinking About COVID-19",
       x = "Country",
       y = "Time Spent Thinking About COVID-19 (hours)")

ggplot(data = cleaned_sta302_performance_data) +
  geom_boxplot(mapping = aes(x = Country, y = STA302.hours..W1.)) +
  labs(title = "Country vs. Week 1 Time Spent Studying For STA302H1",
       x = "Country",
       y = "Time Spent Studying For STA302H1 (hours)")

ggplot(data = cleaned_sta302_performance_data) +
  geom_boxplot(mapping = aes(x = Country, y = STA302.hours..W2.)) +
  labs(title = "Country vs. Week 2 Time Spent Studying For STA302H1",
       x = "Country",
       y = "Time Spent Studying For STA302H1 (hours)")

ggplot(data = cleaned_sta302_performance_data) +
  geom_boxplot(mapping = aes(x = Country, y = STA302.hours..W3.)) +
  labs(title = "Country vs. Week 3 Time Spent Studying For STA302H1",
       x = "Country",
       y = "Time Spent Studying For STA302H1 (hours)")

ggplot(data = cleaned_sta302_performance_data) +
  geom_boxplot(mapping = aes(x = Country, y = STA302.hours..W4.)) +
  labs(title = "Country vs. Week 4 Time Spent Studying For STA302H1",
       x = "Country",
       y = "Time Spent Studying For STA302H1 (hours)")

ggplot(data = cleaned_sta302_performance_data) +
  geom_boxplot(mapping = aes(x = Country, y = Quiz_1_score)) +
  labs(title = "Country vs. Quiz 1 Score",
       x = "Country",
       y = "Score (out of 10)")

ggplot(data = cleaned_sta302_performance_data) +
  geom_boxplot(mapping = aes(x = Country, y = Quiz_2_score)) +
  labs(title = "Country vs. Quiz 2 Score",
       x = "Country",
       y = "Score (out of 10)")

ggplot(data = cleaned_sta302_performance_data) +
  geom_boxplot(mapping = aes(x = Country, y = Quiz_3_score)) +
  labs(title = "Country vs. Quiz 3 Score",
       x = "Country",
       y = "Score (out of 10)")

ggplot(data = cleaned_sta302_performance_data) +
  geom_boxplot(mapping = aes(x = Country, y = Quiz_4_score)) +
  labs(title = "Country vs. Quiz 4 Score",
       x = "Country",
       y = "Score (out of 10)")
```

\break

# Scatterplots

```{r}
# pairwise scatterplot
pairs(~COVID.hours..W1. + COVID.hours..W2. + COVID.hours..W3. + COVID.hours..W4. +
      STA302.hours..W1. + STA302.hours..W2. + STA302.hours..W3. + STA302.hours..W4. +
      Quiz_1_score + Quiz_2_score + Quiz_3_score + Quiz_4_score,
      data = cleaned_sta302_performance_data)
```

\break

# Correlation Matrix

```{r}
# take out country column
# TODO: Or create separate correlation matrices for each country?
no_country = cleaned_sta302_performance_data %>%
  select(-country)
```

```{r}
# Find correlation matrix to determine candidate significant predictor values.
# library(GGally)
colnames(no_country) <- c("W1COV", "W2COV", "W3COV", "W4COV", 
                          "W1302", "W2302", "W3302", "W4302", 
                          "Q1", "Q2", "Q3", "Q4")
# ggcorr(no_country, label = TRUE, label_round = 2)
round(cor(no_country, use = "complete.obs"), 2)  # TODO: na.rm = true
```

\break

# Summary Statistics

## Mean STA302H1 study time

```{r}
mean_STA302H1_study_times <- data.frame(
  week1 = mean(sta302_performance_data$STA302.hours..W1., na.rm = TRUE),
  week2 = mean(sta302_performance_data$STA302.hours..W2., na.rm = TRUE),
  week3 = mean(sta302_performance_data$STA302.hours..W3., na.rm = TRUE),
  week4 = mean(sta302_performance_data$STA302.hours..W4., na.rm = TRUE)
)
mean_STA302H1_study_times
```

## Mean COVID contemplation time

```{R}
mean_COVID_contemplation_times <- data.frame(
  week1 = mean(sta302_performance_data$COVID.hours..W1., na.rm = TRUE),
  week2 = mean(sta302_performance_data$COVID.hours..W2., na.rm = TRUE),
  week3 = mean(sta302_performance_data$COVID.hours..W3., na.rm = TRUE),
  week4 = mean(sta302_performance_data$COVID.hours..W4., na.rm = TRUE)
)
mean_COVID_contemplation_times
```

\break

## Median STA302H1 study time

```{r}
median_STA302H1_study_times <- data.frame(
  week1 = median(sta302_performance_data$STA302.hours..W1., na.rm = TRUE),
  week2 = median(sta302_performance_data$STA302.hours..W2., na.rm = TRUE),
  week3 = median(sta302_performance_data$STA302.hours..W3., na.rm = TRUE),
  week4 = median(sta302_performance_data$STA302.hours..W4., na.rm = TRUE)
)
median_STA302H1_study_times
```

## Median COVID contemplation time

```{r}
median_COVID_contemplation_times <- data.frame(
  week1 = median(sta302_performance_data$COVID.hours..W1., na.rm = TRUE),
  week2 = median(sta302_performance_data$COVID.hours..W2., na.rm = TRUE),
  week3 = median(sta302_performance_data$COVID.hours..W3., na.rm = TRUE),
  week4 = median(sta302_performance_data$COVID.hours..W4., na.rm = TRUE)
)
median_COVID_contemplation_times
```

\break

## Country summary statistics

```{r}
length(which(cleaned_sta302_performance_data$Country == "Canada")) + 2
length(which(is.na(cleaned_sta302_performance_data$Country)))
```

## Study hours summary statistics

```{r}
summary(sta302_performance_data$STA302.hours..W1.)
summary(sta302_performance_data$STA302.hours..W2.)
summary(sta302_performance_data$STA302.hours..W3.)
summary(sta302_performance_data$STA302.hours..W4.)
```

## COVID hours summary statistics

```{r}
summary(sta302_performance_data$COVID.hours..W1.)
summary(sta302_performance_data$COVID.hours..W2.)
summary(sta302_performance_data$COVID.hours..W3.)
summary(sta302_performance_data$COVID.hours..W4.)
```
