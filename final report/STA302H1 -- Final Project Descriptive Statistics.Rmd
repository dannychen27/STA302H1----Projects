---
title: "STA302H1 -- Final Project Descriptive Statistics"
author: "Danny Chen"
date: "August 10, 2021"
output:
  pdf_document: default
---

```{r setup, include = FALSE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(dplyr)
library(tidyverse)
library(GGally)
library(MASS)
```

# Import STA302H1 Study Time and COVID Contemplation Time vs. Quiz Performance Dataset

```{r echo = FALSE, message = FALSE}
setwd("~/Desktop/sta302h1/STA302H1 -- Projects/final report")
sta302_performance_data = read.csv("./data.csv", header = TRUE)
attach(sta302_performance_data)
```

# Data Cleaning

First, I'll clean my data.

```{r}
rearranged_data <- sta302_performance_data %>%
    # Create a new "country" column, which is just "Country" but whose entries are factors.
    mutate(country = as.factor(Country)) %>%
  
    # TODO: Replace quiz grades, covid hours, and sta302h1 study hours with their
    # TODO: median counterparts.

    # Remove the "X" column: it's simply the row number, which isn't very useful.
    # Remove the "Country" column: column "country" already exists
    dplyr::select(-X, -Country) %>%
    
    # Rearrange similar columns side-by-side.
    relocate(country,
             COVID.hours..W1., COVID.hours..W2., COVID.hours..W3., COVID.hours..W4.,
             STA302.hours..W1., STA302.hours..W2., STA302.hours..W3., STA302.hours..W4.,
             Quiz_1_score, Quiz_2_score, Quiz_3_score, Quiz_4_score)
```

\break

# Helper Functions

```{r}
num_column_NAs = function(predictor_variable) {
  sum(is.na(predictor_variable))
}
```

```{r}
row_nums_of_NA_columns = function(data, predictor_variable) {
  which(is.na(predictor_variable))
}
```

```{r}
rows_with_num_NAs = function(data, num_NAs) {
  return (rowSums(is.na(data)) == num_NAs)
}
```

```{r}
row_nums_of_NA_rows = function(data, num_NAs) {
  return (which(rows_with_num_NAs(data, num_NAs)))
}
```

```{r}
display_histogram <- function(data, predictor_variable, histogram_title, x_axis_label) {
  ggplot(data = tibble(data), mapping = aes(x = predictor_variable)) +
    geom_histogram(col = "black", fill = "red", bins = 30) +
    labs(title = histogram_title, y = "Frequency", x = x_axis_label) + 
    geom_vline(mapping = aes(xintercept = mean(predictor_variable, na.rm = TRUE)),
               color = "blue", linetype = "solid") +
    geom_vline(mapping = aes(xintercept = median(predictor_variable, na.rm = TRUE)),
               color = "dark green", linetype = "dotted")
}
```

```{r}
display_boxplot <- function(data, predictor_variable, boxplot_title, y_axis_label) {
  ggplot(mapping = aes(x = Country, y = predictor_variable, color = Country)) +
    geom_boxplot(mapping = aes(x = Country, y = predictor_variable)) +
    labs(title = boxplot_title, x = "Country", y = y_axis_label)
}
```

```{R}
get_row_nums_to_exclude <- function(data) {
  row_nums_with_3_NAs = which(rows_with_num_NAs(data, 3))
  row_nums_with_4_NAs = which(rows_with_num_NAs(data, 4))
  row_nums_to_exclude <- union(row_nums_with_3_NAs,
                               row_nums_with_4_NAs)
  return (row_nums_to_exclude)
}
```

```{r}
display_correlation_by_country <- function(country_data) {
  colnames(country_data) <- c("W1COV", "W2COV", "W3COV", "W4COV",
                              "W1302", "W2302", "W3302", "W4302",
                              "Q1", "Q2", "Q3", "Q4")
  round(cor(country_data, use = "pairwise.complete.obs", method = "pearson"), 2)
}
```

\break

# Special Tables

## Rows With At Least One NA

Rows with at least one NA deserve closer examination. \newline
Some of the rows might only have 1 - 2 NAs and are therefore salvageable, which is OK. \newline
Other rows may contain 3 or more NAs, and might indicate students who have dropped STA302H1. We'd like to exclude them from our analysis.

```{r echo = FALSE, warning = FALSE}
rows_with_0_NAs = rearranged_data[rows_with_num_NAs(rearranged_data, 0),]
rows_with_1_NAs = rearranged_data[rows_with_num_NAs(rearranged_data, 1),]
rows_with_2_NAs = rearranged_data[rows_with_num_NAs(rearranged_data, 2),]
rows_with_3_NAs = rearranged_data[rows_with_num_NAs(rearranged_data, 3),]
rows_with_4_NAs = rearranged_data[rows_with_num_NAs(rearranged_data, 4),]
```

Here are the number of rows with 0 - 4 NAs.

```{r echo = FALSE}
data.frame(
  nrows_0_NAs = nrow(rows_with_0_NAs),
  nrows_1_NAs = nrow(rows_with_1_NAs),
  nrows_2_NAs = nrow(rows_with_2_NAs),
  nrows_3_NAs = nrow(rows_with_3_NAs),
  nrows_4_NAs = nrow(rows_with_4_NAs)
)
```

<!-- We also want to know which row numbers have 0 - 4 NAs. -->

```{r echo = FALSE}
# row_nums_of_NA_rows(rearranged_data, 0)
```

```{r echo = FALSE}
# row_nums_of_NA_rows(rearranged_data, 1)
```

```{r echo = FALSE}
# row_nums_of_NA_rows(rearranged_data, 2)
```

```{r echo = FALSE}
# row_nums_of_NA_rows(rearranged_data, 3)
```

```{r echo = FALSE}
# row_nums_of_NA_rows(rearranged_data, 4)
```

## Columns with NAs

```{R echo = FALSE}
data.frame(
  week1_covid = num_column_NAs(rearranged_data$COVID.hours..W1.),
  week2_covid = num_column_NAs(rearranged_data$COVID.hours..W2.),
  week3_covid = num_column_NAs(rearranged_data$COVID.hours..W3.),
  week4_covid = num_column_NAs(rearranged_data$COVID.hours..W4.)
)
```

```{R echo = FALSE}
data.frame(
  week1_sta302 = num_column_NAs(rearranged_data$STA302.hours..W1.),
  week2_sta302 = num_column_NAs(rearranged_data$STA302.hours..W2.),
  week3_sta302 = num_column_NAs(rearranged_data$STA302.hours..W3.),
  week4_sta302 = num_column_NAs(rearranged_data$STA302.hours..W4.)
)
```

```{R echo = FALSE}
data.frame(
  quiz1_score = num_column_NAs(rearranged_data$Quiz_1_score),
  quiz2_score = num_column_NAs(rearranged_data$Quiz_2_score),
  quiz3_score = num_column_NAs(rearranged_data$Quiz_3_score),
  quiz4_score = num_column_NAs(rearranged_data$Quiz_4_score)
)
```

```{r echo = FALSE, warning = FALSE}
quiz_grades <- rearranged_data %>%
  dplyr::select(Quiz_1_score, Quiz_2_score, Quiz_3_score, Quiz_4_score)
```

```{r echo = FALSE, warning = FALSE}
missed_0_quizzes = quiz_grades[rows_with_num_NAs(quiz_grades, 0),]
missed_1_quizzes = quiz_grades[rows_with_num_NAs(quiz_grades, 1),]
missed_2_quizzes = quiz_grades[rows_with_num_NAs(quiz_grades, 2),]
missed_3_quizzes = quiz_grades[rows_with_num_NAs(quiz_grades, 3),]
missed_4_quizzes = quiz_grades[rows_with_num_NAs(quiz_grades, 4),]
```

## Number of Missed Quizzes

```{r echo = FALSE}
data.frame(
  miss_0_quizzes = nrow(missed_0_quizzes),
  miss_1_quizzes = nrow(missed_1_quizzes),
  miss_2_quizzes = nrow(missed_2_quizzes),
  miss_3_quizzes = nrow(missed_3_quizzes),
  miss_4_quizzes = nrow(missed_4_quizzes)
)
```

<!-- ## Who Missed Quizzes? -->

```{r echo = FALSE}
# which(rows_with_num_NAs(quiz_grades, 0))
```

```{r echo = FALSE}
# which(rows_with_num_NAs(quiz_grades, 1))
```

```{r echo = FALSE}
# which(rows_with_num_NAs(quiz_grades, 2))
```

```{r echo = FALSE}
# which(rows_with_num_NAs(quiz_grades, 3))
```

```{r echo = FALSE}
# which(rows_with_num_NAs(quiz_grades, 4))
```

## Who to Exclude from the Dataset?

Identify rows with at least 3 missing quiz marks. These indicate students who have dropped STA302H1, and who should be excluded from the final data.

Notice that we didn't check the number of NAs for country of origin, COVID hours, and STA302H1 hours, since some students either forgot or abstained. So there's no reason to exclude these students from our final dataset.

```{r}
row_nums_to_exclude <- get_row_nums_to_exclude(quiz_grades)
remaining_data = rearranged_data[-row_nums_to_exclude,]
```

\break

## Rows with Mistyped Columns

Rows whose columns are mis-typed may need to be corrected via imputation.

```{R}
rows_with_mistyped_columms = remaining_data[c(38, 83, 84, 117),]
# row 83: Country -> "canada" -- DONE
# row 84: Country -> "canada" -- DONE

# row 117: COVID.hours..W4. -> 0.5 hours -- DONE

# row 38:  STA302.hours..W3. -> 5.5<U+00A0> -- DONE
# row 117: STA302.hours..W4. -> 7.5 hours -- DONE
```

```{r}
# library(janitor)
# use it to clean up data.
```

## Rows Without Country Entry

Taking out the country column can come in handy for functions like cor() where
factors aren't allowed.

```{r}
rows_with_no_country = remaining_data %>%
  dplyr::select(-country)
```

## Rows Filtered by Country

This is useful if we want data for individual countries. \newline
Only the first and last code snippets are shown.

```{r}
canada <- remaining_data %>%
  filter(as.character(country) == "Canada") %>%
  dplyr::select(-country)

unknown <- remaining_data %>%
  filter(is.na(as.character(country))) %>%
  dplyr::select(-country)
```

```{r echo = FALSE}
china <- remaining_data %>%
  filter(as.character(country) == "China") %>%
  dplyr::select(-country)

india <- remaining_data %>%
  filter(as.character(country) == "India") %>%
  dplyr::select(-country)

japan <- remaining_data %>%
  filter(as.character(country) == "Japan") %>%
  dplyr::select(-country)

mongolia <- remaining_data %>%
  filter(as.character(country) == "Mongolia") %>%
  dplyr::select(-country)

pakistan <- remaining_data %>%
  filter(as.character(country) == "Pakistan") %>%
  dplyr::select(-country)

singapore <- remaining_data %>%
  filter(as.character(country) == "Singapore") %>%
  dplyr::select(-country)

south_korea <- remaining_data %>%
  filter(as.character(country) == "South Korea") %>%
  dplyr::select(-country)

taiwan <- remaining_data %>%
  filter(as.character(country) == "Taiwan") %>%
  dplyr::select(-country)

uae <- remaining_data %>%
  filter(as.character(country) == "UAE") %>%
  dplyr::select(-country)

usa <- remaining_data %>%
  filter(as.character(country) == "USA") %>%
  dplyr::select(-country)
```

```{r echo = FALSE}
countries = data.frame(
  Canada = nrow(canada),
  China = nrow(china),
  India = nrow(india),
  Japan = nrow(japan),
  Mongolia = nrow(mongolia),
  Pakistan = nrow(pakistan),
  Singapore = nrow(singapore),
  South_Korea = nrow(south_korea),
  Taiwan = nrow(taiwan),
  UAE = nrow(uae),
  USA = nrow(usa),
  Unknown = nrow(unknown)
)
rownames(countries) = "Country"
t(countries)
```

\break

```{r echo = FALSE, warning = FALSE}
display_boxplot(remaining_data, COVID.hours..W1.,
                "Country vs. Week 1 Time Spent Thinking About COVID-19",
                "Time Spent Thinking About COVID-19 (hours)")
```

```{r echo = FALSE, warning = FALSE}
display_histogram(remaining_data, remaining_data$COVID.hours..W1., 
                  "Histogram of Week 1 Time Spent Thinking About COVID-19",
                  "Time Spent Thinking About COVID-19 (hours)")
```

\break

```{R echo = FALSE, warning = FALSE}
display_boxplot(remaining_data, COVID.hours..W2.,
                "Country vs. Week 2 Time Spent Thinking About COVID-19",
                "Time Spent Thinking About COVID-19 (hours)")
```

```{r echo = FALSE, warning = FALSE}
display_histogram(remaining_data, remaining_data$COVID.hours..W2., 
                  "Histogram of Week 2 Time Spent Thinking About COVID-19",
                  "Time Spent Thinking About COVID-19 (hours)")
```

\break

```{R echo = FALSE, warning = FALSE}
display_boxplot(remaining_data, COVID.hours..W3.,
                "Country vs. Week 3 Time Spent Thinking About COVID-19",
                "Time Spent Thinking About COVID-19 (hours)")
```

```{r echo = FALSE, warning = FALSE}
display_histogram(remaining_data, remaining_data$COVID.hours..W3., 
                  "Histogram of Week 3 Time Spent Thinking About COVID-19",
                  "Time Spent Thinking About COVID-19 (hours)")
```

\break

```{R echo = FALSE, warning = FALSE}
display_boxplot(remaining_data, COVID.hours..W4.,
                "Country vs. Week 4 Time Spent Thinking About COVID-19",
                "Time Spent Thinking About COVID-19 (hours)")
```

```{r echo = FALSE, warning = FALSE}
display_histogram(remaining_data, remaining_data$COVID.hours..W4., 
                  "Histogram of Week 4 Time Spent Thinking About COVID-19",
                  "Time Spent Thinking About COVID-19 (hours)")
```

\break

```{R echo = FALSE, warning = FALSE}
display_boxplot(remaining_data, STA302.hours..W1.,
                "Country vs. Week 1 Time Spent Studying For STA302H1",
                "Time Spent Studying For STA302H1 (hours)")
```

```{r echo = FALSE, warning = FALSE}
display_histogram(remaining_data, remaining_data$STA302.hours..W1., 
                  "Histogram of Week 1 Time Spent Studying for STA302H1",
                  "Time Spent Studying for STA302H1 (hours)")
```

\break

```{R echo = FALSE, warning = FALSE}
display_boxplot(remaining_data, STA302.hours..W2.,
                "Country vs. Week 2 Time Spent Studying For STA302H1",
                "Time Spent Studying For STA302H1 (hours)")
```

```{r echo = FALSE, warning = FALSE}
display_histogram(remaining_data, remaining_data$STA302.hours..W2., 
                  "Histogram of Week 2 Time Spent Studying for STA302H1",
                  "Time Spent Studying for STA302H1 (hours)")
```

\break

```{R echo = FALSE, warning = FALSE}
display_boxplot(remaining_data, STA302.hours..W3.,
                "Country vs. Week 3 Time Spent Studying For STA302H1",
                "Time Spent Studying For STA302H1 (hours)")
```

```{r echo = FALSE, warning = FALSE}
display_histogram(remaining_data, remaining_data$STA302.hours..W3., 
                  "Histogram of Week 3 Time Spent Studying for STA302H1",
                  "Time Spent Studying for STA302H1 (hours)")
```

\break

```{R echo = FALSE, warning = FALSE}
display_boxplot(remaining_data, STA302.hours..W4.,
                "Country vs. Week 4 Time Spent Studying For STA302H1",
                "Time Spent Studying For STA302H1 (hours)")
```

```{r echo = FALSE, warning = FALSE}
display_histogram(remaining_data, remaining_data$STA302.hours..W4., 
                  "Histogram of Week 4 Time Spent Studying for STA302H1",
                  "Time Spent Studying for STA302H1 (hours)")
```

\break

```{R echo = FALSE, warning = FALSE}
display_boxplot(remaining_data, Quiz_1_score,
                "Country vs. Quiz 1 Score", "Score (out of 10)")
```

```{r echo = FALSE, warning = FALSE}
display_histogram(remaining_data, remaining_data$Quiz_1_score, 
                  "Histogram of Quiz 1 Scores", "Quiz Score (out of 10)")
```

\break

```{R echo = FALSE, warning = FALSE}
display_boxplot(remaining_data, Quiz_2_score,
                "Country vs. Quiz 2 Score", "Score (out of 10)")
```

```{r echo = FALSE, warning = FALSE}
display_histogram(remaining_data, remaining_data$Quiz_2_score, 
                  "Histogram of Quiz 2 Scores", "Quiz Score (out of 10)")
```

\break

```{R echo = FALSE, warning = FALSE}
display_boxplot(remaining_data, Quiz_3_score,
                "Country vs. Quiz 3 Score", "Score (out of 10)")
```

```{r echo = FALSE, warning = FALSE}
display_histogram(remaining_data, remaining_data$Quiz_3_score, 
                  "Histogram of Quiz 3 Scores", "Quiz Score (out of 10)")
```

\break

```{R echo = FALSE, warning = FALSE}
display_boxplot(remaining_data, Quiz_4_score,
                "Country vs. Quiz 4 Score", "Score (out of 10)")
```

```{r echo = FALSE, warning = FALSE}
display_histogram(remaining_data, remaining_data$Quiz_4_score, 
                  "Histogram of Quiz 4 Scores", "Quiz Score (out of 10)")
```

\break

# 5-Number Summary Statistics

```{r}
summary(remaining_data$COVID.hours..W1.)
```

```{r}
summary(remaining_data$COVID.hours..W2.)
```

```{r}
summary(remaining_data$COVID.hours..W3.)
```

```{r}
summary(remaining_data$COVID.hours..W4.)
```

```{r}
summary(remaining_data$STA302.hours..W1.)
```

```{r}
summary(remaining_data$STA302.hours..W2.)
```

```{r}
summary(remaining_data$STA302.hours..W3.)
```

```{r}
summary(remaining_data$STA302.hours..W4.)
```

\break

```{r}
summary(remaining_data$Quiz_1_score)
```

```{r}
summary(remaining_data$Quiz_2_score)
```

```{r}
summary(remaining_data$Quiz_3_score)
```

```{r}
summary(remaining_data$Quiz_4_score)
```

\break

```{r}
remaining_data_no_NAs = na.omit(remaining_data)

quiz1 = remaining_data_no_NAs$Quiz_1_score
quiz2 = remaining_data_no_NAs$Quiz_2_score
quiz3 = remaining_data_no_NAs$Quiz_3_score
quiz4 = remaining_data_no_NAs$Quiz_4_score

covid1 = remaining_data_no_NAs$COVID.hours..W1.
covid2 = remaining_data_no_NAs$COVID.hours..W2.
covid3 = remaining_data_no_NAs$COVID.hours..W3.
covid4 = remaining_data_no_NAs$COVID.hours..W4.

study1 = remaining_data_no_NAs$STA302.hours..W1.
study2 = remaining_data_no_NAs$STA302.hours..W2.
study3 = remaining_data_no_NAs$STA302.hours..W3.
study4 = remaining_data_no_NAs$STA302.hours..W4.

country = remaining_data_no_NAs$country
```

## Full Model (Without Splitting by Country)

```{r}
# single variable per term = additive model
first_model = lm(
  quiz4 ~ 
    quiz1  # scatterplot seems to have no relationship
  + quiz2  # scatterplot seems to have no relationship
  + quiz3  # scatterplot looks more linear
  + covid1 # must add this linear term b/c i have a quadratic term 
  + I(covid1 ^ 2)  # scatterplot looks more quadratic
  + covid2 # must add this linear term b/c i have a quadratic term 
  + I(covid2 ^ 2)  # scatterplot looks more quadratic
  + covid3
  # + I(covid3 ^ 2) # scatterplot looks less quadratic
  + covid4  # must add this linear term b/c i have a quadratic term 
  + I(covid4 ^ 2) # scatterplot looks more quadratic
  
  + I(covid1 * covid2) # first impressions from correlation matrix
  + I(covid2 * covid3) # correlation = 0.67
  + I(covid2 * covid4) # discard: correlation = 0.71
  + I(covid3 * covid4) # correlation = 0.72
  
  + I(study1 * study2)  # correlation = 0.61
  + I(study1 * study3)  # correlation = 0.58
  + I(study2 * study3)  # correlation = 0.70
  + I(study3 * study4)  # correlation = 0.62
  
  + country  # for simplicity, but backwards process shows this term is not significant
)
summary(first_model)
```

```{r}
stepAIC(first_model, direction = "forward")$anova
```

```{r}
stepAIC(first_model, direction = "backward")$anova
```

```{r}
stepAIC(first_model, direction = "both")$anova
```

```{r}
final_model = lm(
  quiz4 ~ quiz3 + 
    I(covid1 ^ 2) 
  + I(covid1 * covid2) + I(covid2 * covid3) 
  + I(study1 * study2) + I(study1 * study3) + I(study2 * study3) + I(study3 * study4)
)
summary(final_model)
```

```{r}
stepAIC(final_model, direction = "forward")$anova
```

```{r}
stepAIC(final_model, direction = "backward")$anova
```

```{r}
stepAIC(final_model, direction = "both")$anova
```

```{r}
# I decide to remove more terms for simplicity.
third_model = lm(
quiz4 ~ quiz3
  # + I(covid1 ^ 2)  # this lone quadratic term add a lot of complexity for negligible change in R^2 and adjusted R^2.
  # + I(covid1 * covid2) + I(covid2 * covid3) # these terms alone add complexity -- harder to interpret the statement when discussing 2-week or 3-week gaps between covid weeks of interest # TODO: does it affect significance?

  + I(study1 * study2) 
# + I(study1 * study3)  # make weeks consecutive: "want to see correlation from week to week", rather than non-consecutive weeks.
  + I(study2 * study3) 
  + I(study3 * study4)
)
summary(third_model)
```

```{r}
# Doing stepAIC on a well-fitted model produces the same model.
# The model is already in a "steady state."
stepAIC(third_model, direction = "both")$anova
```

```{r}
stepAIC(third_model, direction = "forward")$anova
```

```{r}
stepAIC(third_model, direction = "backward")$anova
```

```{r}
fourth_model = lm(quiz4 ~ quiz3)
summary(fourth_model)
```

```{r}
stepAIC(fourth_model, direction = "forward")$anova
```

```{r}
stepAIC(fourth_model, direction = "backward")$anova
```

```{r}
stepAIC(fourth_model, direction = "both")$anova
```

```{r}
display_residual_plot <- function(data, model, predictor_variable) {
  fit = fitted(model)
  residuals = resid(model)
  ggplot(data = data, aes(x = predictor_variable, y = residuals)) +
    geom_point() + 
    geom_hline(yintercept = 0)
}
```

## residual plot

```{r}
display_residual_plot(remaining_data_no_NAs, second_model, quiz3)
```

```{r}
display_residual_plot(remaining_data_no_NAs, second_model, study1 * study2)
```

```{r}
display_residual_plot(remaining_data_no_NAs, second_model, study2 * study3)
```

```{r}
display_residual_plot(remaining_data_no_NAs, second_model, study3 * study4)
```

## residual vs. fit, qqplot, scale-location, and residual vs. leverage

```{r}
plot(second_model)
```

```{r}
hist(lm(second_model)$residuals)
mean(lm(second_model)$residuals)
median(lm(second_model)$residuals)
```

## Try Predicting on the Fitted Values

```{r}
predicted_values = predict(second_model)
actual_values = remaining_data_no_NAs$Quiz_4_score
```

```{r}
mean(predicted_values - actual_values)
```

```{r}
median(predicted_values - actual_values)
```

```{r}
hist(predicted_values - actual_values)
```

```{r}
t.test(predicted_values - actual_values)
```

## 50/50 Training/Testing

## partitioning

```{r}
# https://stackoverflow.com/questions/17200114/how-to-split-data-into-training-testing-sets-using-sample-function

set.seed(888)
library(caTools)
sample = sample.split(remaining_data_no_NAs, SplitRatio = 0.55)
training_data = subset(remaining_data_no_NAs, sample == TRUE)
testing_data  = subset(remaining_data_no_NAs, sample == FALSE)
```

## training

```{r}
training_data_no_NAs = na.omit(training_data)

quiz1 = training_data_no_NAs$Quiz_1_score
quiz2 = training_data_no_NAs$Quiz_2_score
quiz3 = training_data_no_NAs$Quiz_3_score
quiz4 = training_data_no_NAs$Quiz_4_score

covid1 = training_data_no_NAs$COVID.hours..W1.
covid2 = training_data_no_NAs$COVID.hours..W2.
covid3 = training_data_no_NAs$COVID.hours..W3.
covid4 = training_data_no_NAs$COVID.hours..W4.

study1 = training_data_no_NAs$STA302.hours..W1.
study2 = training_data_no_NAs$STA302.hours..W2.
study3 = training_data_no_NAs$STA302.hours..W3.
study4 = training_data_no_NAs$STA302.hours..W4.

country = training_data_no_NAs$country
```

```{r}
second_model = lm(
quiz4 ~ quiz3
  # + I(covid1 * covid2)
  # + I(covid2 * covid3) 
  # + I(covid3 * covid4)

  + I(study1 * study2)
  + I(study2 * study3) 
  + I(study3 * study4)
)
summary(second_model)
```

# testing

```{r}
testing_data_no_NAs = na.omit(testing_data)

quiz1 = testing_data_no_NAs$Quiz_1_score
quiz2 = testing_data_no_NAs$Quiz_2_score
quiz3 = testing_data_no_NAs$Quiz_3_score
quiz4 = testing_data_no_NAs$Quiz_4_score

covid1 = testing_data_no_NAs$COVID.hours..W1.
covid2 = testing_data_no_NAs$COVID.hours..W2.
covid3 = testing_data_no_NAs$COVID.hours..W3.
covid4 = testing_data_no_NAs$COVID.hours..W4.

study1 = testing_data_no_NAs$STA302.hours..W1.
study2 = testing_data_no_NAs$STA302.hours..W2.
study3 = testing_data_no_NAs$STA302.hours..W3.
study4 = testing_data_no_NAs$STA302.hours..W4.

country = testing_data_no_NAs$country
```

```{r}
predicted_values = predict(second_model, testing_data_no_NAs)
predicted_values
```

```{r}
actual_values = testing_data$Quiz_4_score
actual_values
```

```{r}
predicted_values - actual_values
```

```{r}
mean(predicted_values - actual_values)
```

```{r}
median(predicted_values - actual_values)
```

```{r}
hist(predicted_values - actual_values)
```

# one-sample t-test on mean

hypothesized mean = 0

- n = 77, so by CLT sample mean is approximately normal

is -0.427222 statistically different from 0?
the p-value should be small.

```{R}
t.test(predicted_values - actual_values)
```

p-value = 0.7938
t = -0.26242

